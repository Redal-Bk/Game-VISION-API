@model UserPCSpecsDto
@using System.Text
@using Game_Vision.Application.DTO.UserPcReq
@using Game_Vision.Domain.Basic

@{
    Layout = "_Layout";
}
<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GameVision - پروفایل کاربر</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <link rel="stylesheet" href="~/css/Style/styles.css">
</head>
<body>
    <div class="container mt-5">
        <div class="row">
            <div class="col-lg-4">
                <div class="system-specs text-center">
                    @{
                        var discordId = User.FindFirst(System.Security.Claims.ClaimTypes.NameIdentifier)?.Value;
                        var avatarHash = User.FindFirst("urn:discord:avatar")?.Value;
                        var username = User.FindFirst(System.Security.Claims.ClaimTypes.Name)?.Value ?? "کاربر دیسکورد";
                        var globalName = User.FindFirst("urn:discord:global_name")?.Value;
                        var displayName = !string.IsNullOrEmpty(globalName) ? globalName : username;
                        string avatarUrl;
                        if (!string.IsNullOrEmpty(discordId) && !string.IsNullOrEmpty(avatarHash))
                        {
                            avatarUrl = $"https://cdn.discordapp.com/avatars/{discordId}/{avatarHash}.png?size=512";
                        }
                        else
                        {
                            avatarUrl = "data:image/svg+xml;base64," + Convert.ToBase64String(Encoding.UTF8.GetBytes(@"
                                        <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100' width='64' height='64'>
                                        <defs>
                                        <linearGradient id='neonGrad' x1='0%' y1='0%' x2='100%' y2='100%'>
                                        <stop offset='0%' style='stop-color:#00f0ff' />
                                        <stop offset='100%' style='stop-color:#b200ff' />
                                        </linearGradient>
                                        </defs>
                                        <circle cx='50' cy='50' r='48' fill='none' stroke='url(#neonGrad)' stroke-width='4' opacity='0.8'/>
                                        <circle cx='50' cy='35' r='15' fill='none' stroke='url(#neonGrad)' stroke-width='3'/>
                                        <path d='M30 60 Q50 80 70 60' stroke='url(#neonGrad)' stroke-width='3' fill='none'/>
                                        <circle cx='35' cy='30' r='4' fill='url(#neonGrad)'/>
                                        <circle cx='65' cy='30' r='4' fill='url(#neonGrad)'/>
                                        </svg>
                                        "));
                        }
                    }
                    <img src="@avatarUrl" alt="Avatar" class="profile-avatar mb-3"
                         onerror="this.src='https://cdn.discordapp.com/embed/avatars/0.png';">
                    <h3 class="mb-2">@displayName</h3>
                    <p class="text-secondary mb-3">@username</p>
                    <div class="d-flex justify-content-center gap-3 mb-4">
                        <div class="text-center">
                            <h5 class="mb-0">127</h5>
                            <small class="text-secondary">بازی‌ها</small>
                        </div>
                        <div class="text-center" style="border-right: 1px solid var(--border-color); border-left: 1px solid var(--border-color); padding: 0 1rem;">
                            <h5 class="mb-0">45</h5>
                            <small class="text-secondary">بررسی</small>
                        </div>
                        <div class="text-center">
                            <h5 class="mb-0">892</h5>
                            <small class="text-secondary">امتیاز</small>
                        </div>
                    </div>
                    <p class="text-secondary mb-4" style="line-height: 1.8;">
                        یک گیمر حرفه‌ای با علاقه به بازی‌های RPG و اکشن-ماجراجویی. عاشق داستان‌های قوی و گیم‌پلی چالشی.
                    </p>
                    <button class="btn btn-outline-neon w-100 mb-2">
                        <i class="bi bi-pencil"></i> ویرایش پروفایل
                    </button>
                    <button class="btn btn-outline-neon w-100">
                        <i class="bi bi-gear"></i> تنظیمات
                    </button>
                </div>
                <div class="system-specs mt-4">
                    <h5 class="mb-3">مشخصات سیستم من</h5>
                    @if (Model != null)
                    {
                        <div class="spec-item">
                            <div class="d-flex justify-content-between">
                                <span class="text-secondary">پردازنده:</span>
                                <span>@(string.IsNullOrEmpty(Model.CPU) ? "نامشخص" : Model.CPU)</span>
                            </div>
                        </div>
                        <div class="spec-item">
                            <div class="d-flex justify-content-between">
                                <span class="text-secondary">کارت گرافیک:</span>
                                <span>@(string.IsNullOrEmpty(Model.GPU) ? "نامشخص" : Model.GPU)</span>
                            </div>
                        </div>
                        <div class="spec-item">
                            <div class="d-flex justify-content-between">
                                <span class="text-secondary">رم:</span>
                                <span>@(Model.RAM > 0 ? $"{Model.RAM} GB" : "نامشخص")</span>
                            </div>
                        </div>
                        <div class="spec-item">
                            <div class="d-flex justify-content-between">
                                <span class="text-secondary">حافظه:</span>
                                <span>@(Model.Storage > 0 ? $"{Model.Storage} GB" : "نامشخص")</span>
                            </div>
                        </div>
                        <div class="spec-item">
                            <div class="d-flex justify-content-between">
                                <span class="text-secondary">سیستم عامل:</span>
                                <span>@(string.IsNullOrEmpty(Model.OS) ? "نامشخص" : Model.OS)</span>
                            </div>
                        </div>
                        <div class="spec-item">
                            <div class="d-flex justify-content-between">
                                <span class="text-secondary">DirectX:</span>
                                <span>@(string.IsNullOrEmpty(Model.DirectX) ? "نامشخص" : Model.DirectX)</span>
                            </div>
                        </div>
                    }
                    else
                    {
                        <p class="text-secondary text-center">مشخصات سیستم ثبت نشده است.</p>
                    }
                    <button type="button" class="btn btn-outline-neon btn-sm w-100 mt-3" data-bs-toggle="modal" data-bs-target="#editPCSpecsModal">
                        <i class="bi bi-pencil"></i> ویرایش مشخصات
                    </button>
                </div>
                <div class="system-specs mt-4">
                    <h5 class="mb-3">دستاوردها</h5>
                    <div class="d-flex flex-wrap gap-2">
                        <span class="badge-genre" title="100 بازی تکمیل شده">
                            <i class="bi bi-trophy"></i> قهرمان
                        </span>
                        <span class="badge-genre" title="50 بررسی نوشته شده">
                            <i class="bi bi-star"></i> منتقد
                        </span>
                        <span class="badge-genre" title="عضو 1 ساله">
                            <i class="bi bi-calendar"></i> وفادار
                        </span>
                        <span class="badge-genre" title="100 نظر مفید">
                            <i class="bi bi-heart"></i> محبوب
                        </span>
                    </div>
                </div>
            </div>
            <div class="col-lg-8">
                <ul class="nav nav-tabs mb-4" style="border-bottom: 2px solid var(--border-color);">
                    <li class="nav-item">
                        <a class="nav-link active" data-bs-toggle="tab" href="#favorites" style="color: var(--primary-neon); border-color: var(--primary-neon);">
                            <i class="bi bi-heart-fill"></i> علاقه‌مندی‌ها
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" data-bs-toggle="tab" href="#reviews" style="color: var(--text-secondary);">
                            <i class="bi bi-star"></i> بررسی‌ها
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" data-bs-toggle="tab" href="#activity" style="color: var(--text-secondary);">
                            <i class="bi bi-clock-history"></i> فعالیت‌ها
                        </a>
                    </li>
                </ul>
                <div class="tab-content">
                    <div class="tab-pane fade show active" id="favorites">
                        <h4 class="mb-4">بازی‌های مورد علاقه من</h4>
                        <div class="row g-4">
                            <div class="col-md-6">
                                <div class="card-game">
                                    <img src="~/Images/LastOfUs.png" alt="Game">
                                    <div class="card-game-body">
                                        <h5 class="card-game-title">The Last of Us Part III</h5>
                                        <div class="d-flex justify-content-between align-items-center mb-2">
                                            <div class="rating-stars">
                                                <i class="bi bi-star-fill"></i>
                                                <i class="bi bi-star-fill"></i>
                                                <i class="bi bi-star-fill"></i>
                                                <i class="bi bi-star-fill"></i>
                                                <i class="bi bi-star"></i>
                                                <span class="small">4.0</span>
                                            </div>
                                            <span class="badge-neon">PS5</span>
                                        </div>
                                        <p class="text-secondary small mb-3">یک بازی اکشن-ماجراجویی پس از آخرالزمانی...</p>
                                        <a href="game-detail.html" class="btn btn-outline-neon btn-sm w-100">مشاهده جزئیات</a>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="card-game">
                                    <img src="~/Images/CyberPunk.jpg" alt="Game">
                                    <div class="card-game-body">
                                        <h5 class="card-game-title">Cyberpunk 2077</h5>
                                        <div class="d-flex justify-content-between align-items-center mb-2">
                                            <div class="rating-stars">
                                                <i class="bi bi-star-fill"></i>
                                                <i class="bi bi-star-fill"></i>
                                                <i class="bi bi-star-fill"></i>
                                                <i class="bi bi-star-fill"></i>
                                                <i class="bi bi-star-half"></i>
                                                <span class="small">4.5</span>
                                            </div>
                                            <span class="badge-neon">PC</span>
                                        </div>
                                        <p class="text-secondary small mb-3">در دنیای آینده نقش یک مزدور را بازی کنید...</p>
                                        <a href="game-detail.html" class="btn btn-outline-neon btn-sm w-100">مشاهده جزئیات</a>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="card-game">
                                    <img src="~/Images/HogwartsLegasy.png" alt="Game">
                                    <div class="card-game-body">
                                        <h5 class="card-game-title">Hogwarts Legacy</h5>
                                        <div class="d-flex justify-content-between align-items-center mb-2">
                                            <div class="rating-stars">
                                                <i class="bi bi-star-fill"></i>
                                                <i class="bi bi-star-fill"></i>
                                                <i class="bi bi-star-fill"></i>
                                                <i class="bi bi-star-fill"></i>
                                                <i class="bi bi-star-fill"></i>
                                                <span class="small">5.0</span>
                                            </div>
                                            <span class="badge-neon">Multi</span>
                                        </div>
                                        <p class="text-secondary small mb-3">وارد دنیای جادوگری هری پاتر شوید...</p>
                                        <a href="game-detail.html" class="btn btn-outline-neon btn-sm w-100">مشاهده جزئیات</a>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="card-game">
                                    <img src="~/Images/Ragnarok.jpg" alt="Game">
                                    <div class="card-game-body">
                                        <h5 class="card-game-title">God of War Ragnarök</h5>
                                        <div class="d-flex justify-content-between align-items-center mb-2">
                                            <div class="rating-stars">
                                                <i class="bi bi-star-fill"></i>
                                                <i class="bi bi-star-fill"></i>
                                                <i class="bi bi-star-fill"></i>
                                                <i class="bi bi-star-fill"></i>
                                                <i class="bi bi-star-half"></i>
                                                <span class="small">4.7</span>
                                            </div>
                                            <span class="badge-neon">PS5</span>
                                        </div>
                                        <p class="text-secondary small mb-3">کریتوس و آترئوس در ماجراجویی جدید...</p>
                                        <a href="game-detail.html" class="btn btn-outline-neon btn-sm w-100">مشاهده جزئیات</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="tab-pane fade" id="reviews">
                        <h4 class="mb-4">بررسی‌های من</h4>
                        <div class="review-card">
                            <div class="d-flex justify-content-between align-items-start mb-3">
                                <div>
                                    <h5 class="mb-2">Cyberpunk 2077</h5>
                                    <div class="rating-stars">
                                        <i class="bi bi-star-fill"></i>
                                        <i class="bi bi-star-fill"></i>
                                        <i class="bi bi-star-fill"></i>
                                        <i class="bi bi-star-fill"></i>
                                        <i class="bi bi-star-half"></i>
                                    </div>
                                </div>
                                <span class="text-secondary small">2 روز پیش</span>
                            </div>
                            <p class="text-secondary mb-3">
                                یکی از بهترین بازی‌هایی که تا به حال تجربه کردم. داستان عالی، گرافیک بی‌نظیر
                                و گیم‌پلی متنوع. بعد از بروزرسانی‌های اخیر، بازی به شکل فوق‌العاده‌ای بهینه شده.
                            </p>
                            <div class="d-flex gap-2">
                                <button class="btn btn-outline-neon btn-sm">
                                    <i class="bi bi-pencil"></i> ویرایش
                                </button>
                                <button class="btn btn-outline-neon btn-sm">
                                    <i class="bi bi-trash"></i> حذف
                                </button>
                            </div>
                        </div>
                        <div class="review-card">
                            <div class="d-flex justify-content-between align-items-start mb-3">
                                <div>
                                    <h5 class="mb-2">God of War Ragnarök</h5>
                                    <div class="rating-stars">
                                        <i class="bi bi-star-fill"></i>
                                        <i class="bi bi-star-fill"></i>
                                        <i class="bi bi-star-fill"></i>
                                        <i class="bi bi-star-fill"></i>
                                        <i class="bi bi-star-fill"></i>
                                    </div>
                                </div>
                                <span class="text-secondary small">1 هفته پیش</span>
                            </div>
                            <p class="text-secondary mb-3">
                                شاهکار واقعی! داستان بی‌نظیر، گرافیک خیره‌کننده و گیم‌پلی کامل. رابطه کریتوس
                                و آترئوس خیلی عمیق و احساسی شده. یکی از بهترین بازی‌های نسل جدید.
                            </p>
                            <div class="d-flex gap-2">
                                <button class="btn btn-outline-neon btn-sm">
                                    <i class="bi bi-pencil"></i> ویرایش
                                </button>
                                <button class="btn btn-outline-neon btn-sm">
                                    <i class="bi bi-trash"></i> حذف
                                </button>
                            </div>
                        </div>
                        <div class="review-card">
                            <div class="d-flex justify-content-between align-items-start mb-3">
                                <div>
                                    <h5 class="mb-2">Hogwarts Legacy</h5>
                                    <div class="rating-stars">
                                        <i class="bi bi-star-fill"></i>
                                        <i class="bi bi-star-fill"></i>
                                        <i class="bi bi-star-fill"></i>
                                        <i class="bi bi-star-fill"></i>
                                        <i class="bi bi-star"></i>
                                    </div>
                                </div>
                                <span class="text-secondary small">2 هفته پیش</span>
                            </div>
                            <p class="text-secondary mb-3">
                                برای طرفداران هری پاتر عالیه! دنیای جادوگری به خوبی ساخته شده و کاوش در
                                هاگوارتز فوق‌العاده است. فقط داستان اصلی می‌تونست قوی‌تر باشه.
                            </p>
                            <div class="d-flex gap-2">
                                <button class="btn btn-outline-neon btn-sm">
                                    <i class="bi bi-pencil"></i> ویرایش
                                </button>
                                <button class="btn btn-outline-neon btn-sm">
                                    <i class="bi bi-trash"></i> حذف
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="tab-pane fade" id="activity">
                        <h4 class="mb-4">آخرین فعالیت‌ها</h4>
                        <div class="review-card">
                            <div class="d-flex gap-3">
                                <div style="color: var(--accent-red);">
                                    <i class="bi bi-heart-fill fs-4"></i>
                                </div>
                                <div class="flex-grow-1">
                                    <p class="mb-1">
                                        <strong>Cyberpunk 2077</strong> را به علاقه‌مندی‌ها اضافه کردید
                                    </p>
                                    <small class="text-secondary">2 روز پیش</small>
                                </div>
                            </div>
                        </div>
                        <div class="review-card">
                            <div class="d-flex gap-3">
                                <div style="color: var(--accent-green);">
                                    <i class="bi bi-star-fill fs-4"></i>
                                </div>
                                <div class="flex-grow-1">
                                    <p class="mb-1">
                                        بررسی جدیدی برای <strong>God of War Ragnarök</strong> نوشتید
                                    </p>
                                    <small class="text-secondary">1 هفته پیش</small>
                                </div>
                            </div>
                        </div>
                        <div class="review-card">
                            <div class="d-flex gap-3">
                                <div style="color: var(--secondary-neon);">
                                    <i class="bi bi-chat-fill fs-4"></i>
                                </div>
                                <div class="flex-grow-1">
                                    <p class="mb-1">
                                        نظری در خبر <strong>عنوان جدید God of War</strong> گذاشتید
                                    </p>
                                    <small class="text-secondary">1 هفته پیش</small>
                                </div>
                            </div>
                        </div>
                        <div class="review-card">
                            <div class="d-flex gap-3">
                                <div style="color: var(--accent-red);">
                                    <i class="bi bi-heart-fill fs-4"></i>
                                </div>
                                <div class="flex-grow-1">
                                    <p class="mb-1">
                                        <strong>Hogwarts Legacy</strong> را به علاقه‌مندی‌ها اضافه کردید
                                    </p>
                                    <small class="text-secondary">2 هفته پیش</small>
                                </div>
                            </div>
                        </div>
                        <div class="review-card">
                            <div class="d-flex gap-3">
                                <div style="color: var(--accent-green);">
                                    <i class="bi bi-star-fill fs-4"></i>
                                </div>
                                <div class="flex-grow-1">
                                    <p class="mb-1">
                                        بررسی جدیدی برای <strong>Hogwarts Legacy</strong> نوشتید
                                    </p>
                                    <small class="text-secondary">2 هفته پیش</small>
                                </div>
                            </div>
                        </div>
                        <div class="review-card">
                            <div class="d-flex gap-3">
                                <div style="color: var(--primary-neon);">
                                    <i class="bi bi-gear-fill fs-4"></i>
                                </div>
                                <div class="flex-grow-1">
                                    <p class="mb-1">
                                        مشخصات سیستم خود را به‌روزرسانی کردید
                                    </p>
                                    <small class="text-secondary">3 هفته پیش</small>
                                </div>
                            </div>
                        </div>
                        <div class="review-card">
                            <div class="d-flex gap-3">
                                <div style="color: var(--accent-red);">
                                    <i class="bi bi-heart-fill fs-4"></i>
                                </div>
                                <div class="flex-grow-1">
                                    <p class="mb-1">
                                        <strong>The Last of Us Part II</strong> را به علاقه‌مندی‌ها اضافه کردید
                                    </p>
                                    <small class="text-secondary">1 ماه پیش</small>
                                </div>
                            </div>
                        </div>
                        <div class="review-card">
                            <div class="d-flex gap-3">
                                <div style="color: var(--secondary-neon);">
                                    <i class="bi bi-chat-fill fs-4"></i>
                                </div>
                                <div class="flex-grow-1">
                                    <p class="mb-1">
                                        نظری در خبر <strong>تاریخ انتشار GTA 6</strong> گذاشتید
                                    </p>
                                    <small class="text-secondary">1 ماه پیش</small>
                                </div>
                            </div>
                        </div>
                        <div class="review-card">
                            <div class="d-flex gap-3">
                                <div style="color: var(--accent-green);">
                                    <i class="bi bi-star-fill fs-4"></i>
                                </div>
                                <div class="flex-grow-1">
                                    <p class="mb-1">
                                        بررسی جدیدی برای <strong>The Last of Us Part II</strong> نوشتید
                                    </p>
                                    <small class="text-secondary">1 ماه پیش</small>
                                </div>
                            </div>
                        </div>
                        <div class="review-card">
                            <div class="d-flex gap-3">
                                <div style="color: var(--primary-neon);">
                                    <i class="bi bi-person-plus-fill fs-4"></i>
                                </div>
                                <div class="flex-grow-1">
                                    <p class="mb-1">
                                        به GameVision پیوستید
                                    </p>
                                    <small class="text-secondary">2 ماه پیش</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- مودال ویرایش مشخصات سیستم با ComboBox -->
    <div class="modal fade" id="editPCSpecsModal" tabindex="-1" aria-labelledby="editPCSpecsModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content" style="background: var(--bg-card); border: 1px solid var(--border-color);">
                <div class="modal-header" style="border-bottom: 1px solid var(--border-color);">
                    <h5 class="modal-title" id="editPCSpecsModalLabel" style="color: var(--primary-neon);">
                        <i class="bi bi-gear me-2"></i>ویرایش مشخصات سیستم
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="بستن"></button>
                </div>
                <div class="modal-body">
                    <form id="editPCSpecsForm">
                        <div class="mb-3">
                            <label class="form-label">سیستم عامل</label>
                            <select class="form-control-custom" id="os">
                                @foreach (var os in ViewData["Oses"] as List<OsList>)
                                {
                                    <option value="@os.Name">@os.Name</option>
                                }
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">پردازنده (CPU)</label>
                            <select class="form-control-custom" id="cpu">
                                @foreach (var cpu in ViewData["Cpus"] as List<CpuList>)
                                {
                                    <option value="@cpu.Name">@cpu.Name</option>
                                }
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">رم (به گیگابایت)</label>
                            <select class="form-control-custom" id="ram">
                                @foreach (var ram in ViewData["Rams"] as List<RamList>)
                                {
                                    var ramValue = ram.Name.Replace(" GB", "").Trim();
                                    <option value="@ramValue">@ram.Name</option>
                                }
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">کارت گرافیک (GPU)</label>
                            <select class="form-control-custom" id="gpu">
                                @foreach (var gpu in ViewData["Gpus"] as List<GpuList>)
                                {
                                    <option value="@gpu.Name">@gpu.Name</option>
                                }
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">DirectX</label>
                            <input type="text" class="form-control-custom" id="directx" value="@(Model?.DirectX ?? "")">
                        </div>
                        <div class="mb-3">
                            <label class="form-label">حافظه (به گیگابایت)</label>
                            <select class="form-control-custom" id="storage">
                                @foreach (var storage in ViewData["Storages"] as List<StorageList>)
                                {
                                    var storageValue = storage.Name.Replace(" GB", "").Replace(" TB", "000").Trim();
                                    <option value="@storageValue">@storage.Name</option>
                                }
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer" style="border-top: 1px solid var(--border-color);">
                    <button type="button" class="btn btn-outline-neon" data-bs-dismiss="modal">لغو</button>
                    <button type="button" class="btn btn-neon" id="savePCSpecs">
                        <i class="bi bi-save me-2"></i>ذخیره تغییرات
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // وقتی مودال باز می‌شه، گزینه‌های فعلی رو selected کن
        const modal = document.getElementById('editPCSpecsModal');
        modal.addEventListener('show.bs.modal', function () {
            const currentOS = "@(Model?.OS ?? "")";
            const currentCPU = "@(Model?.CPU ?? "")";
            const currentRAM = "@(Model?.RAM ?? 8)";
            const currentGPU = "@(Model?.GPU ?? "")";
            const currentStorage = "@(Model?.Storage ?? 256)";

            document.getElementById('os').value = currentOS;
            document.getElementById('cpu').value = currentCPU;
            document.getElementById('ram').value = currentRAM;
            document.getElementById('gpu').value = currentGPU;
            document.getElementById('storage').value = currentStorage;
        });

        // ذخیره با AJAX
        document.getElementById('savePCSpecs')?.addEventListener('click', async () => {
            const formData = {
                OS: document.getElementById('os').value.trim(),
                CPU: document.getElementById('cpu').value.trim(),
                RAM: parseInt(document.getElementById('ram').value) || 8,
                GPU: document.getElementById('gpu').value.trim(),
                DirectX: document.getElementById('directx').value.trim(),
                Storage: parseInt(document.getElementById('storage').value) || 256
            };

            try {
                const response = await fetch('/Profile/pcspecs', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'RequestVerificationToken': document.querySelector('input[name="__RequestVerificationToken"]')?.value || ''
                    },
                    body: JSON.stringify(formData)
                });

                if (response.ok) {
                    bootstrap.Modal.getInstance(modal).hide();
                    alert('مشخصات سیستم با موفقیت ذخیره شد!');
                    location.reload();
                } else {
                    alert('خطا در ذخیره مشخصات');
                }
            } catch (err) {
                console.error(err);
                alert('خطا در ارتباط با سرور');
            }
        });
    </script>
</body>
</html>